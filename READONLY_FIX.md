# åªè¯»æ–‡ä»¶ç³»ç»Ÿé”™è¯¯ä¿®å¤

## ğŸš¨ é—®é¢˜æè¿°

```
error Error: EROFS: read-only file system, open '/app/package.json'
```

**é—®é¢˜åŸå› **: æŒ‚è½½çš„ `package.json` æ–‡ä»¶è®¾ç½®ä¸ºåªè¯» (`:ro`)ï¼Œä½† `yarn add` éœ€è¦ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ã€‚

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### å·²ä¿®å¤çš„é…ç½®

1. **docker-compose.yml** âœ… - ç§»é™¤äº† package.json åªè¯»æŒ‚è½½
2. **docker-run.sh** âœ… - ç§»é™¤äº† package.json æŒ‚è½½
3. **test-mdx-fix.sh** âœ… - ç§»é™¤äº† package.json æŒ‚è½½

### ä¿®å¤é€»è¾‘

```yaml
# âŒ ä¿®å¤å‰ - å¯¼è‡´åªè¯»é”™è¯¯
volumes:
  - ./package.json:/app/package.json:ro

# âœ… ä¿®å¤å - ä¸æŒ‚è½½ï¼Œä½¿ç”¨å®¹å™¨å†…çš„æ–‡ä»¶
volumes:
  # package.json æŒ‚è½½å·²ç§»é™¤
```

## ğŸ¯ æ–°çš„å·¥ä½œæµç¨‹

### 1. å®¹å™¨å¯åŠ¨æµç¨‹
1. **ä½¿ç”¨å®¹å™¨å†…ç½®çš„ package.json**
2. **è¿è¡Œä¾èµ–æ£€æŸ¥è„šæœ¬** (`fix-deps.sh`)
3. **è‡ªåŠ¨å®‰è£…ç¼ºå¤±çš„ MDX ä¾èµ–**
4. **æ­£å¸¸å¯åŠ¨ Next.js æœåŠ¡**

### 2. ä¾èµ–ä¿®å¤è¿‡ç¨‹
```bash
ğŸ”§ æ£€æŸ¥å’Œä¿®å¤ä¾èµ–...
âŒ ç¼ºå¤±ä¾èµ–: @next/mdx
âŒ ç¼ºå¤±ä¾èµ–: @mdx-js/loader
âŒ ç¼ºå¤±ä¾èµ–: @mdx-js/react
âŒ ç¼ºå¤±ä¾èµ–: @types/mdx

ğŸ“¦ å®‰è£…ç¼ºå¤±çš„ä¾èµ–...
ğŸŒ ä½¿ç”¨å®˜æ–¹npmæº: https://registry.npmjs.org/
âœ… ä¾èµ–å®‰è£…å®Œæˆ

ğŸ” æœ€ç»ˆéªŒè¯ä¾èµ–å¯ç”¨æ€§...
âœ… @next/mdx å¯ä»¥æ­£å¸¸åŠ è½½

ğŸš€ å¯åŠ¨ Next.js æœåŠ¡...
```

## ğŸš€ ç«‹å³ä½¿ç”¨

### é‡æ–°å¯åŠ¨æœåŠ¡

#### æ–¹å¼1: docker-compose
```bash
# åœæ­¢å½“å‰æœåŠ¡
docker-compose down

# é‡æ–°å¯åŠ¨ (ä½¿ç”¨ä¿®å¤åçš„é…ç½®)
docker-compose up -d

# æŸ¥çœ‹ä¿®å¤è¿‡ç¨‹
docker-compose logs -f app
```

#### æ–¹å¼2: å¯åŠ¨è„šæœ¬
```bash
# åœæ­¢å½“å‰å®¹å™¨ (Ctrl+C)
# é‡æ–°è¿è¡Œ
./docker-run.sh
# é€‰æ‹© "1" å‰å°å¯åŠ¨
```

#### æ–¹å¼3: æµ‹è¯•è„šæœ¬
```bash
# å¿«é€Ÿæµ‹è¯•ä¿®å¤æ•ˆæœ
./test-mdx-fix.sh
```

## ğŸ“‹ é¢„æœŸç»“æœ

### âœ… æˆåŠŸå¯åŠ¨
```bash
ğŸ”§ æ£€æŸ¥å’Œä¿®å¤ä¾èµ–...
âŒ ç¼ºå¤±ä¾èµ–: @next/mdx
ğŸ“¦ å®‰è£…ç¼ºå¤±çš„ä¾èµ–: @next/mdx@^14.2.3 @mdx-js/loader@^3.0.1 @mdx-js/react@^3.0.1 @types/mdx@^2.0.13
ğŸŒ ä½¿ç”¨å®˜æ–¹npmæº: https://registry.npmjs.org/
âœ… ä¾èµ–å®‰è£…å®Œæˆ
ğŸ” æœ€ç»ˆéªŒè¯ä¾èµ–å¯ç”¨æ€§...
âœ… @next/mdx å¯ä»¥æ­£å¸¸åŠ è½½
ğŸš€ å¯åŠ¨ Next.js æœåŠ¡...

  â–² Next.js 14.2.3
  - Local:        http://localhost:3000
  âœ“ Ready in 2134ms
```

### âŒ å¦‚æœä»æœ‰é—®é¢˜
å¦‚æœä»ç„¶é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. **æ–‡ä»¶æƒé™**
   ```bash
   # ç¡®ä¿è„šæœ¬å¯æ‰§è¡Œ
   chmod +x fix-deps.sh
   ```

2. **å®¹å™¨æƒé™**
   ```bash
   # æ£€æŸ¥å®¹å™¨æ˜¯å¦æœ‰å†™æƒé™
   docker run --rm markdown-to-image-serve:latest ls -la /app
   ```

3. **æ‰‹åŠ¨éªŒè¯**
   ```bash
   # æ‰‹åŠ¨è¿›å…¥å®¹å™¨æµ‹è¯•
   docker run --rm -it markdown-to-image-serve:latest /bin/bash
   cd /app
   yarn add @next/mdx@^14.2.3
   ```

## ğŸ‰ ä¼˜åŠ¿

âœ… **ä¸å†æœ‰åªè¯»æ–‡ä»¶ç³»ç»Ÿé”™è¯¯**  
âœ… **ä¾èµ–å¯ä»¥æ­£å¸¸å®‰è£…**  
âœ… **ä¸éœ€è¦ä¿®æ”¹ä¸»æœºä¸Šçš„ package.json**  
âœ… **å®¹å™¨å†…çš„ä¿®æ”¹ä¸ä¼šå½±å“ä¸»æœº**  
âœ… **æ¯æ¬¡å¯åŠ¨éƒ½ç¡®ä¿ä¾èµ–å®Œæ•´**  

## ğŸ“Š æ€»ç»“

| é—®é¢˜ | ä¿®å¤å‰ | ä¿®å¤å |
|------|-------|-------|
| **æ–‡ä»¶æƒé™** | âŒ åªè¯»æŒ‚è½½ | âœ… å®¹å™¨å†…å¯å†™ |
| **ä¾èµ–å®‰è£…** | âŒ EROFS é”™è¯¯ | âœ… æ­£å¸¸å®‰è£… |
| **æœåŠ¡å¯åŠ¨** | âŒ å¤±è´¥ | âœ… æˆåŠŸ |
| **é…ç½®å¤æ‚åº¦** | âŒ éœ€è¦æŒ‚è½½ | âœ… è‡ªåŠ¨å¤„ç† |

**ç°åœ¨é‡æ–°å¯åŠ¨æœåŠ¡åº”è¯¥å®Œå…¨æ­£å¸¸äº†ï¼** ğŸš€
